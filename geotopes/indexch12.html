<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>12 Programming practicals</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<!-- html,2,next --> 
<meta name="src" content="index.tex"> 
<link rel="stylesheet" type="text/css" href="index.css"> 
</head><body 
>
   <!--l. 2768--><div class="crosslinks"><p class="noindent">[<a 
href="indexch11.html" >prev</a>] [<a 
href="indexch11.html#tailindexch11.html" >prev-tail</a>] [<a 
href="#tailindexch12.html">tail</a>] [<a 
href="index.html#indexch12.html" >up</a>] </p></div>
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;12</span><br /><a 
 id="x16-4400012"></a>Programming practicals</h2>
<!--l. 2771--><p class="noindent" >In this Chapter you will process some real geochronological datasets using
either <span 
class="cmtt-10">R </span>or <span 
class="cmtt-10">Matlab</span>. These are both mathematical scripting languages that
are both powerful and easy to use.<br 
class="newline" />
<!--l. 2776--><p class="indent" >   <span 
class="cmtt-10">R </span>is a free and open programming language that works on any operating
system, including <span 
class="cmtt-10">Windows</span>, <span 
class="cmtt-10">OS-X </span>and <span 
class="cmtt-10">Unix/Linux</span>. It can be downloaded
and installed from <span 
class="cmtt-10">http://r-project.org</span>.<br 
class="newline" />
<!--l. 2781--><p class="indent" >   <span 
class="cmtt-10">Matlab </span>is a proprietary programming environment. The full version of
this software is very expensive but a reasonably complete student version
can be purchased for <span 
class="cmti-10">&pound;</span>55 + VAT from <span 
class="cmtt-10">http://mathworks.com</span>.
Alternatively, <span 
class="cmtt-10">Octave </span>is an open source clone of <span 
class="cmtt-10">Matlab </span>that can be
downloaded for free from <span 
class="cmtt-10">http://www.gnu.org/software/octave</span>.<br 
class="newline" />
<!--l. 2788--><p class="indent" >   Sections&#x00A0;<a 
href="#x16-4500012.1">12.1<!--tex4ht:ref: sec:R --></a> and <a 
href="#x16-4600012.2">12.2<!--tex4ht:ref: sec:Matlab --></a> will present two brief tutorials of <span 
class="cmtt-10">R </span>and <span 
class="cmtt-10">Matlab</span>,
respectively. These will cover most commands that you will need for the
subsequent computer practicals.
   <h3 class="sectionHead"><span class="titlemark">12.1   </span> <a 
 id="x16-4500012.1"></a>Introduction to <span 
class="cmtt-10">R</span></h3>
<!--l. 2796--><p class="noindent" >A number of different graphical user interfaces (GUIs) are available to
interact with <span 
class="cmtt-10">R</span>. The most popular of these are <span 
class="cmtt-10">Rgui</span>, <span 
class="cmtt-10">RStudio</span>, <span 
class="cmtt-10">RCommander</span>
and <span 
class="cmtt-10">Tinn-R</span>.
<!--l. 2801--><p class="indent" >
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x16-45002x1">Starting  these  applications  or  running  <span 
class="cmtt-10">R </span>in  a  text  terminal
     presents the user with a command line prompt. Anything that is
     typed after the <span 
class="cmtt-10">&#x003E; </span>symbol will be evaluated immediately. Thus, we
     can use <span 
class="cmtt-10">R </span>as a calculator:
                                                           
                                                           
     <div class="verbatim" id="verbatim-1">
     &#x003E;&#x00A0;1&#x00A0;+&#x00A0;1
     &#x00A0;<br />&#x003E;&#x00A0;sqrt(2)
     &#x00A0;<br />&#x003E;&#x00A0;exp(log(10))
     &#x00A0;<br />&#x003E;&#x00A0;31&#x00A0;%%&#x00A0;14
</div>
     <!--l. 2812--><p class="nopar" >
     </li>
     <li 
  class="enumerate" id="x16-45004x2">Alternatively, code can also be saved as text (using a built-in text
     editor) and saved as <span 
class="cmtt-10">mycode.R</span>, say. This code can then be copied and
     pasted at the command line prompt. Or it can be called from the
     command line using the <span 
class="cmtt-10">source() </span>function:
                                                           
                                                           
     <div class="verbatim" id="verbatim-2">
     &#x003E;&#x00A0;source('mycode.R')
</div>
     <!--l. 2821--><p class="nopar" >
     </li>
     <li 
  class="enumerate" id="x16-45006x3">In the remainder of this tutorial, we will assume that your code is run
     from a text file unless explicitly stated otherwise. The <span 
class="cmtt-10">#</span>&#x00A0;symbol
     marks the beginning of a comment. <span 
class="cmtt-10">R </span>ignores anything that follows
     it:
                                                           
                                                           
     <div class="verbatim" id="verbatim-3">
     #&#x00A0;The&#x00A0;arrow&#x00A0;symbol&#x00A0;is&#x00A0;used&#x00A0;to&#x00A0;assign&#x00A0;a&#x00A0;value&#x00A0;to&#x00A0;a
     &#x00A0;<br />#&#x00A0;variable.&#x00A0;Note&#x00A0;that&#x00A0;the&#x00A0;arrow&#x00A0;can&#x00A0;point&#x00A0;both&#x00A0;ways:
     &#x00A0;<br />foo&#x00A0;&#x003C;-&#x00A0;2
     &#x00A0;<br />4&#x00A0;-&#x003E;&#x00A0;bar
     &#x00A0;<br />print(foo*bar)
     &#x00A0;<br />
     &#x00A0;<br />#&#x00A0;Defining&#x00A0;a&#x00A0;vector&#x00A0;of&#x00A0;multiple&#x00A0;values:
     &#x00A0;<br />myvec&#x00A0;&#x003C;-&#x00A0;c(0,1,2,3,4,5)
     &#x00A0;<br />#&#x00A0;or,&#x00A0;equivalently:
     &#x00A0;<br />myvec&#x00A0;&#x003C;-&#x00A0;seq(0,5)
     &#x00A0;<br />#&#x00A0;or
     &#x00A0;<br />myvec&#x00A0;&#x003C;-&#x00A0;seq(from=0,to=5,by=1)
     &#x00A0;<br />#&#x00A0;or
     &#x00A0;<br />myvec&#x00A0;&#x003C;-&#x00A0;0:5
     &#x00A0;<br />
     &#x00A0;<br />#&#x00A0;Turn&#x00A0;myvec&#x00A0;into&#x00A0;a&#x00A0;2x3&#x00A0;matrix:
     &#x00A0;<br />mymat&#x00A0;&#x003C;-&#x00A0;matrix(myvec,nrow=2)
     &#x00A0;<br />
     &#x00A0;<br />#&#x00A0;Accessing&#x00A0;one&#x00A0;or&#x00A0;more&#x00A0;elements&#x00A0;from&#x00A0;a&#x00A0;vector&#x00A0;or&#x00A0;matrix:
     &#x00A0;<br />x&#x00A0;&#x003C;-&#x00A0;myvec[3]
     &#x00A0;<br />y&#x00A0;&#x003C;-&#x00A0;myvec[1:3]
     &#x00A0;<br />z&#x00A0;&#x003C;-&#x00A0;mymat[1,2:3]
     &#x00A0;<br />
     &#x00A0;<br />#&#x00A0;Change&#x00A0;the&#x00A0;third&#x00A0;value&#x00A0;in&#x00A0;the&#x00A0;second&#x00A0;row&#x00A0;of&#x00A0;mymat&#x00A0;to&#x00A0;10:
     &#x00A0;<br />mymat[2,3]&#x00A0;&#x003C;-&#x00A0;10
     &#x00A0;<br />
     &#x00A0;<br />#&#x00A0;Change&#x00A0;the&#x00A0;entire&#x00A0;second&#x00A0;column&#x00A0;of&#x00A0;mymat&#x00A0;to&#x00A0;-1:
     &#x00A0;<br />mymat[,2]&#x00A0;&#x003C;-&#x00A0;-1
     &#x00A0;<br />
     &#x00A0;<br />#&#x00A0;Transpose&#x00A0;of&#x00A0;a&#x00A0;matrix:
     &#x00A0;<br />flipped&#x00A0;&#x003C;-&#x00A0;t(mymat)
     &#x00A0;<br />
     &#x00A0;<br />#&#x00A0;Element-wise&#x00A0;multiplication&#x00A0;(*)
     &#x00A0;<br />#&#x00A0;vs.&#x00A0;matrix&#x00A0;multiplication&#x00A0;(%*%):
     &#x00A0;<br />rectangle&#x00A0;&#x003C;-&#x00A0;mymat&#x00A0;*&#x00A0;mymat
     &#x00A0;<br />square&#x00A0;&#x003C;-&#x00A0;mymat&#x00A0;%*%&#x00A0;flipped
                                                           
                                                           
</div>
     <!--l. 2865--><p class="nopar" >
     </li>
     <li 
  class="enumerate" id="x16-45008x4">If you want to learn more about a function, type <span 
class="cmtt-10">help() </span>or <span 
class="cmtt-10">? </span>at the
     command line prompt:
                                                           
                                                           
     <div class="verbatim" id="verbatim-4">
     &#x003E;&#x00A0;help(c)
     &#x00A0;<br />&#x003E;&#x00A0;?matrix
</div>
     <!--l. 2873--><p class="nopar" >
     </li>
     <li 
  class="enumerate" id="x16-45010x5">In addition to <span 
class="cmtt-10">R</span>&#8217;s built-in functions, you can also define your
     own:
                                                           
                                                           
     <div class="verbatim" id="verbatim-5">
     cube&#x00A0;&#x003C;-&#x00A0;function(n){
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;return(n^3)
     &#x00A0;<br />}
     &#x00A0;<br />
     &#x00A0;<br />#&#x00A0;Using&#x00A0;this&#x00A0;function&#x00A0;to&#x00A0;take&#x00A0;the&#x00A0;cube&#x00A0;of&#x00A0;3:
     &#x00A0;<br />c3&#x00A0;&#x003C;-&#x00A0;cube(3)
     &#x00A0;<br />
     &#x00A0;<br />#&#x00A0;Conditional&#x00A0;statement:
     &#x00A0;<br />toss&#x00A0;&#x003C;-&#x00A0;function(){
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;(runif(1)&#x003E;0.5){&#x00A0;#&#x00A0;runif(n)&#x00A0;draws&#x00A0;n&#x00A0;random
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;print("head")&#x00A0;&#x00A0;#&#x00A0;numbers&#x00A0;between&#x00A0;0&#x00A0;and&#x00A0;1
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;}&#x00A0;else&#x00A0;{
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;print("tail")
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
     &#x00A0;<br />}
     &#x00A0;<br />
     &#x00A0;<br />#&#x00A0;Use&#x00A0;a&#x00A0;for&#x00A0;loop&#x00A0;to&#x00A0;toss&#x00A0;10&#x00A0;virtual&#x00A0;coins:
     &#x00A0;<br />for&#x00A0;(i&#x00A0;in&#x00A0;1:10)&#x00A0;{
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;toss()
     &#x00A0;<br />}
</div>
     <!--l. 2899--><p class="nopar" >
     </li>
     <li 
  class="enumerate" id="x16-45012x6">The purpose of the practical exercises in Sections&#x00A0;<a 
href="#x16-4700012.3">12.3<!--tex4ht:ref: sec:U-Pb-R --></a>-<a 
href="#x16-5000012.6">12.6<!--tex4ht:ref: sec:FT-R --></a> is to
     process datasets contained in external data files. For this you will need
     to be able to navigate through your file system and load the necessary
     files:
                                                           
                                                           
     <div class="verbatim" id="verbatim-6">
     &#x003E;&#x00A0;ls()&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;list&#x00A0;all&#x00A0;the&#x00A0;variables
     &#x00A0;<br />&#x003E;&#x00A0;rm(list=ls())&#x00A0;#&#x00A0;clear&#x00A0;the&#x00A0;current&#x00A0;workspace
     &#x00A0;<br />&#x003E;&#x00A0;getwd()&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;get&#x00A0;the&#x00A0;current&#x00A0;working&#x00A0;directory
     &#x00A0;<br />&#x003E;&#x00A0;setwd("path_to_a_valid_directory")
</div>
     <!--l. 2911--><p class="nopar" >
     </li>
     <li 
  class="enumerate" id="x16-45014x7">Use the above commands to navigate to the directory containing the
     file named <span 
class="cmtt-10">RbSr.csv</span>. Then read this file into memory:
                                                           
                                                           
     <div class="verbatim" id="verbatim-7">
     RbSr&#x00A0;&#x003C;-&#x00A0;read.csv("RbSr.csv",header=TRUE)
</div>
     <!--l. 2918--><p class="nopar" >
     <!--l. 2920--><p class="noindent" >Type <span 
class="cmtt-10">names(RbSr) </span>or <span 
class="cmtt-10">colnames(RbSr) </span>at the command prompt to
     list the variable names (column headers) contained in this
     dataset.
     </li>
     <li 
  class="enumerate" id="x16-45016x8">Let us now perform an isochron regression (Section&#x00A0;<a 
href="indexch4.html#x7-150004.2">4.2<!--tex4ht:ref: sec:Rb-Sr --></a>) through these
     Rb-Sr data: <a 
 id="x16-450158"></a>
                                                           
                                                           
     <div class="verbatim" id="verbatim-8">
     #&#x00A0;Plot&#x00A0;Sr87Sr86&#x00A0;against&#x00A0;Rb87Sr86:
     &#x00A0;<br />plot(RbSr[,'Rb87Sr86'],RbSr[,'Sr87Sr86'],type="p")
     &#x00A0;<br />
     &#x00A0;<br />#&#x00A0;fit&#x00A0;a&#x00A0;linear&#x00A0;model&#x00A0;to&#x00A0;the&#x00A0;data
     &#x00A0;<br />fit&#x00A0;&#x003C;-&#x00A0;lm(Sr87Sr86&#x00A0;~&#x00A0;Rb87Sr86,&#x00A0;data&#x00A0;=&#x00A0;RbSr)
</div>
     <!--l. 2933--><p class="nopar" >
     </li>
     <li 
  class="enumerate" id="x16-45018x9"><span 
class="cmtt-10">fit </span>is a &#8216;list&#8217; object. Type <span 
class="cmtt-10">str(fit) </span>at the command prompt to see
     its structure. One of its items is <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10">fit$coefficients</span></span></span>, which
     contains the slope and the intercept of the linear fit. Alternatively,
     we can also access these values using the <span 
class="cmtt-10">coef() </span>function.
     The following code uses this function to calculate the isochron
     age:
                                                           
                                                           
     <div class="verbatim" id="verbatim-9">
     #&#x00A0;define&#x00A0;the&#x00A0;87Rb&#x00A0;decay&#x00A0;constant&#x00A0;(in&#x00A0;Ma-1):
     &#x00A0;<br />lam87&#x00A0;&#x003C;-&#x00A0;1.42e-5
     &#x00A0;<br />#&#x00A0;compute&#x00A0;the&#x00A0;age&#x00A0;from&#x00A0;the&#x00A0;slope:
     &#x00A0;<br />age&#x00A0;&#x003C;-&#x00A0;log(1&#x00A0;+&#x00A0;coef(fit)[2])/lam87
     &#x00A0;<br />
     &#x00A0;<br />#&#x00A0;predict&#x00A0;the&#x00A0;Sr87Sr86-ratios&#x00A0;for&#x00A0;the
     &#x00A0;<br />#&#x00A0;full&#x00A0;range&#x00A0;of&#x00A0;Rb87Sr86-values:
     &#x00A0;<br />Rb87Sr86&#x00A0;&#x003C;-&#x00A0;c(0,max(RbSr[,'Rb87Sr86']))
     &#x00A0;<br />Sr87Sr86&#x00A0;&#x003C;-&#x00A0;coef(fit)[1]&#x00A0;+&#x00A0;coef(fit)[2]*Rb87Sr86
     &#x00A0;<br />
     &#x00A0;<br />#&#x00A0;add&#x00A0;the&#x00A0;predicted&#x00A0;ratios&#x00A0;to&#x00A0;the&#x00A0;existing&#x00A0;plot:
     &#x00A0;<br />lines(Rb87Sr86,Sr87Sr86)
     &#x00A0;<br />#&#x00A0;label&#x00A0;with&#x00A0;the&#x00A0;isochron&#x00A0;age:
     &#x00A0;<br />title(age)
</div>
     <!--l. 2957--><p class="nopar" >
     </li>
     <li 
  class="enumerate" id="x16-45020x10">One of the most powerful features of <span 
class="cmtt-10">R </span>is the availability of
     thousands of &#8216;packages&#8217; providing additional functionality to the
     built-in functions. For example, let us download and install the
     <span 
class="cmtt-10">IsoplotR </span>package from the &#8216;Comprehensive R Archive Network&#8217;
     (CRAN):
                                                           
                                                           
     <div class="verbatim" id="verbatim-10">
     &#x003E;&#x00A0;install.packages('IsoplotR')
</div>
     <!--l. 2967--><p class="nopar" >
     </li>
     <li 
  class="enumerate" id="x16-45022x11">We can use <span 
class="cmtt-10">IsoplotR </span>to redo the isochron regression exercise using a
     more rigorous weighted regression algorithm that takes into
     account the analytical uncertainties in both the <sup class="textsuperscript"><span 
class="cmr-9">87</span></sup>Sr/<sup class="textsuperscript"><span 
class="cmr-9">86</span></sup>Sr- and
     <sup class="textsuperscript"><span 
class="cmr-9">87</span></sup>Rb/<sup class="textsuperscript"><span 
class="cmr-9">86</span></sup>Sr-ratios:
                                                           
                                                           
     <div class="verbatim" id="verbatim-11">
     #&#x00A0;load&#x00A0;the&#x00A0;functionality&#x00A0;of&#x00A0;the&#x00A0;IsoplotR&#x00A0;package:
     &#x00A0;<br />library('IsoplotR')
     &#x00A0;<br />
     &#x00A0;<br />#&#x00A0;load&#x00A0;the&#x00A0;data&#x00A0;(see&#x00A0;?read.data&#x00A0;for&#x00A0;details):
     &#x00A0;<br />RbSr2&#x00A0;&#x003C;-&#x00A0;read.data('RbSr.csv',method='Rb-Sr',format=1)
     &#x00A0;<br />
     &#x00A0;<br />#&#x00A0;compute&#x00A0;and&#x00A0;plot&#x00A0;the&#x00A0;isochron&#x00A0;diagram:
     &#x00A0;<br />isochron(RbSr2)
</div>
     <!--l. 2984--><p class="nopar" >
     </li></ol>
<!--l. 2988--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">12.2   </span> <a 
 id="x16-4600012.2"></a>Introduction to <span 
class="cmtt-10">Matlab</span></h3>
<!--l. 2991--><p class="noindent" >
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x16-46002x1"><span 
class="cmtt-10">Matlab</span>, like <span 
class="cmtt-10">R</span>, allows the user to run code either directly at the
     command line prompt, or from a built-in text editor. Anything
     following a percent symbol (<span 
class="cmtt-10">%</span>) is a comment and is ignored. It
     is considered good practice to document your code with lots of
     comments, as will be done in this tutorial.
                                                           
                                                           
     <div class="verbatim" id="verbatim-12">
     %&#x00A0;Ending&#x00A0;a&#x00A0;line&#x00A0;with&#x00A0;a&#x00A0;semi-colon
     &#x00A0;<br />%&#x00A0;suppresses&#x00A0;output&#x00A0;to&#x00A0;the&#x00A0;console:
     &#x00A0;<br />'be&#x00A0;loud'
     &#x00A0;<br />'stay&#x00A0;quiet';
     &#x00A0;<br />
     &#x00A0;<br />%&#x00A0;Matlab&#x00A0;can&#x00A0;be&#x00A0;used&#x00A0;as&#x00A0;a&#x00A0;fancy&#x00A0;calculator:
     &#x00A0;<br />1&#x00A0;+&#x00A0;1
     &#x00A0;<br />sqrt(2)
     &#x00A0;<br />exp(log(10))
     &#x00A0;<br />
     &#x00A0;<br />%&#x00A0;Intermediate&#x00A0;values&#x00A0;can&#x00A0;be&#x00A0;stored&#x00A0;in&#x00A0;variables:
     &#x00A0;<br />foo&#x00A0;=&#x00A0;2;
     &#x00A0;<br />bar&#x00A0;=&#x00A0;4;
     &#x00A0;<br />foo&#x00A0;=&#x00A0;foo*bar;
     &#x00A0;<br />foo
</div>
     <!--l. 3014--><p class="nopar" >
     </li>
     <li 
  class="enumerate" id="x16-46004x2">As the name suggest, <span 
class="cmtt-10">Matlab </span>(which stands for <span 
class="cmtt-10">MAT</span>rix <span 
class="cmtt-10">LAB</span>oratory) is
     capable of, and excels at, dealing with collections of multiple numbers
     arranged in vectors and matrices:
                                                           
                                                           
     <div class="verbatim" id="verbatim-13">
     %&#x00A0;Data&#x00A0;can&#x00A0;be&#x00A0;entered&#x00A0;as&#x00A0;vectors:
     &#x00A0;<br />x&#x00A0;=&#x00A0;[0&#x00A0;2&#x00A0;4&#x00A0;6&#x00A0;8&#x00A0;10]
     &#x00A0;<br />%&#x00A0;or&#x00A0;using&#x00A0;shorthand&#x00A0;syntax:
     &#x00A0;<br />y&#x00A0;=&#x00A0;0:2:10
     &#x00A0;<br />
     &#x00A0;<br />%&#x00A0;Define&#x00A0;a&#x00A0;matrix
     &#x00A0;<br />z&#x00A0;=&#x00A0;[1&#x00A0;2&#x00A0;3
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4&#x00A0;5&#x00A0;6
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;7&#x00A0;8&#x00A0;9];
     &#x00A0;<br />
     &#x00A0;<br />%&#x00A0;Accessing&#x00A0;one&#x00A0;or&#x00A0;more&#x00A0;elements
     &#x00A0;<br />%&#x00A0;from&#x00A0;a&#x00A0;matrix&#x00A0;or&#x00A0;vector:
     &#x00A0;<br />x(3)
     &#x00A0;<br />y(1:3)
     &#x00A0;<br />z(1:2,2:3)
     &#x00A0;<br />
     &#x00A0;<br />%&#x00A0;Attention:&#x00A0;'*',&#x00A0;'/'&#x00A0;and&#x00A0;'^'&#x00A0;symbols
     &#x00A0;<br />%&#x00A0;are&#x00A0;reserved&#x00A0;for&#x00A0;matrix&#x00A0;operations:
     &#x00A0;<br />a&#x00A0;=&#x00A0;[1&#x00A0;1&#x00A0;1]&#x00A0;&#x00A0;%&#x00A0;row&#x00A0;vector
     &#x00A0;<br />b&#x00A0;=&#x00A0;[1;1;1]&#x00A0;&#x00A0;%&#x00A0;column&#x00A0;vector
     &#x00A0;<br />a*b
     &#x00A0;<br />
     &#x00A0;<br />%&#x00A0;Use&#x00A0;'.*',&#x00A0;'./'&#x00A0;and&#x00A0;'.^'&#x00A0;for
     &#x00A0;<br />%&#x00A0;element-wise&#x00A0;operations:
     &#x00A0;<br />a.*a
     &#x00A0;<br />
     &#x00A0;<br />%&#x00A0;Transpose&#x00A0;of&#x00A0;a&#x00A0;matrix:
     &#x00A0;<br />z'
</div>
     <!--l. 3050--><p class="nopar" >
     </li>
     <li 
  class="enumerate" id="x16-46006x3">In addition to Matlab&#8217;s built-in operators and functions, you can also
     define your own:
                                                           
                                                           
     <div class="verbatim" id="verbatim-14">
     %&#x00A0;take&#x00A0;the&#x00A0;cube&#x00A0;of&#x00A0;the&#x00A0;input&#x00A0;argument:
     &#x00A0;<br />function&#x00A0;out&#x00A0;=&#x00A0;cube(in)
     &#x00A0;<br />&#x00A0;&#x00A0;out&#x00A0;=&#x00A0;in^3;
     &#x00A0;<br />end
</div>
     <!--l. 3060--><p class="nopar" >
     <!--l. 3062--><p class="noindent" >Copy the <span 
class="cmtt-10">cube </span>function into a text file named <span 
class="cmtt-10">cube.m </span>and save it in
     the current directory. You can then load the contents of the file by
     simply typing its name without the <span 
class="cmtt-10">.m </span>extension:
                                                           
                                                           
     <div class="verbatim" id="verbatim-15">
     c3&#x00A0;=&#x00A0;cube(3)
</div>
     <!--l. 3069--><p class="nopar" >
     </li>
     <li 
  class="enumerate" id="x16-46008x4">A useful feature of Matlab that is missing from most other
     programming languages is the ability to accommodate several output
     parameters:
                                                           
                                                           
     <div class="verbatim" id="verbatim-16">
     function&#x00A0;[m,s]&#x00A0;=&#x00A0;basicStats(dat)
     &#x00A0;<br />&#x00A0;&#x00A0;m&#x00A0;=&#x00A0;mean(dat);&#x00A0;%&#x00A0;mean
     &#x00A0;<br />&#x00A0;&#x00A0;s&#x00A0;=&#x00A0;std(dat);&#x00A0;&#x00A0;%&#x00A0;standard&#x00A0;deviation
     &#x00A0;<br />end
     &#x00A0;<br />
     &#x00A0;<br />%&#x00A0;create&#x00A0;a&#x00A0;row&#x00A0;vector&#x00A0;of&#x00A0;10&#x00A0;random&#x00A0;numbers
     &#x00A0;<br />randnum&#x00A0;=&#x00A0;rand(1,10);
     &#x00A0;<br />
     &#x00A0;<br />%&#x00A0;use&#x00A0;our&#x00A0;new&#x00A0;function
     &#x00A0;<br />[m,s]&#x00A0;=&#x00A0;basicStats(randnum)
</div>
     <!--l. 3086--><p class="nopar" >
     <!--l. 3088--><p class="noindent" >An extensive library of documentation is built into <span 
class="cmtt-10">Matlab</span>.
     For example, to access further information about the <span 
class="cmtt-10">rand</span>
     function, simply type <span 
class="cmtt-10">help rand </span>or <span 
class="cmtt-10">doc rand </span>at the command
     prompt.
     </li>
     <li 
  class="enumerate" id="x16-46010x5"><span 
class="cmtt-10">Matlab </span>is a fully fledged programming language, which has flow
     structures such as <span 
class="cmtt-10">if </span>statements and <span 
class="cmtt-10">for </span>loops:
                                                           
                                                           
     <div class="verbatim" id="verbatim-17">
     %&#x00A0;Conditional&#x00A0;statement:
     &#x00A0;<br />function&#x00A0;coinToss
     &#x00A0;<br />&#x00A0;&#x00A0;%&#x00A0;'rand()'&#x00A0;produces&#x00A0;numbers&#x00A0;between&#x00A0;0&#x00A0;and&#x00A0;1
     &#x00A0;<br />&#x00A0;&#x00A0;if&#x00A0;(rand()&#x00A0;&#x003E;&#x00A0;0.5)
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;%&#x00A0;display&#x00A0;a&#x00A0;message&#x00A0;to&#x00A0;the&#x00A0;console
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;disp('head')
     &#x00A0;<br />&#x00A0;&#x00A0;else
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;disp('tail')
     &#x00A0;<br />&#x00A0;&#x00A0;end
     &#x00A0;<br />end
     &#x00A0;<br />
     &#x00A0;<br />%&#x00A0;Use&#x00A0;this&#x00A0;function&#x00A0;in&#x00A0;a&#x00A0;for&#x00A0;loop:
     &#x00A0;<br />for&#x00A0;i=1:10,
     &#x00A0;<br />&#x00A0;&#x00A0;coinToss
     &#x00A0;<br />end
</div>
     <!--l. 3113--><p class="nopar" >
     </li>
     <li 
  class="enumerate" id="x16-46012x6">File and variable management:
                                                           
                                                           
     <div class="verbatim" id="verbatim-18">
     %&#x00A0;List&#x00A0;all&#x00A0;the&#x00A0;variables&#x00A0;in&#x00A0;the&#x00A0;current&#x00A0;workspace:
     &#x00A0;<br />who
     &#x00A0;<br />whos
     &#x00A0;<br />
     &#x00A0;<br />%&#x00A0;Remove&#x00A0;some&#x00A0;or&#x00A0;all&#x00A0;variables&#x00A0;from&#x00A0;the&#x00A0;workspace:
     &#x00A0;<br />clear&#x00A0;m,s
     &#x00A0;<br />who
     &#x00A0;<br />clear&#x00A0;all
     &#x00A0;<br />who
     &#x00A0;<br />
     &#x00A0;<br />%&#x00A0;Basic&#x00A0;file&#x00A0;management&#x00A0;is&#x00A0;done&#x00A0;with&#x00A0;UNIX&#x00A0;commands:
     &#x00A0;<br />pwd&#x00A0;&#x00A0;&#x00A0;%&#x00A0;pass&#x00A0;the&#x00A0;working&#x00A0;directory
     &#x00A0;<br />cd&#x00A0;..&#x00A0;%&#x00A0;move&#x00A0;up&#x00A0;one&#x00A0;directory
     &#x00A0;<br />ls&#x00A0;&#x00A0;&#x00A0;&#x00A0;%&#x00A0;list&#x00A0;all&#x00A0;files&#x00A0;in&#x00A0;the&#x00A0;current&#x00A0;directory
</div>
     <!--l. 3132--><p class="nopar" >
     <!--l. 3134--><p class="noindent" >Use the above commands to navigate to the directory containing the
     <span 
class="cmtt-10">RbSr.csv </span>file.
                                                           
                                                           
     <div class="verbatim" id="verbatim-19">
     %&#x00A0;To&#x00A0;view&#x00A0;the&#x00A0;contents&#x00A0;of&#x00A0;this&#x00A0;file:
     &#x00A0;<br />type('RbSr.csv')
     &#x00A0;<br />
     &#x00A0;<br />%&#x00A0;Incidentally,&#x00A0;the&#x00A0;'type'&#x00A0;function&#x00A0;can&#x00A0;also
     &#x00A0;<br />%&#x00A0;be&#x00A0;used&#x00A0;to&#x00A0;view&#x00A0;the&#x00A0;code&#x00A0;of&#x00A0;Matlab&#x00A0;functions:
     &#x00A0;<br />type('mean')
</div>
     <!--l. 3144--><p class="nopar" >
     </li>
     <li 
  class="enumerate" id="x16-46014x7">Let us now apply our knowledge of <span 
class="cmtt-10">Matlab </span>to a geochronological
     problem:
                                                           
                                                           
     <div class="verbatim" id="verbatim-20">
     %&#x00A0;Read&#x00A0;the&#x00A0;Rb-Sr&#x00A0;dataset&#x00A0;ignoring&#x00A0;the&#x00A0;header:
     &#x00A0;<br />RbSr&#x00A0;=&#x00A0;csvread('RbSr.csv',1,0);
     &#x00A0;<br />
     &#x00A0;<br />%&#x00A0;Plot&#x00A0;the&#x00A0;Sr87Sr86-ratio&#x00A0;(first&#x00A0;column)
     &#x00A0;<br />%&#x00A0;against&#x00A0;the&#x00A0;Rb87Sr86-ratio&#x00A0;(third&#x00A0;column):
     &#x00A0;<br />Rb87Sr86&#x00A0;=&#x00A0;RbSr(:,1);
     &#x00A0;<br />Sr87Sr86&#x00A0;=&#x00A0;RbSr(:,3);
     &#x00A0;<br />plot(Rb87Sr86,Sr87Sr86,'ok')
     &#x00A0;<br />xlabel('87Rb/86Sr')
     &#x00A0;<br />ylabel('87Sr/86Sr')
</div>
     <!--l. 3160--><p class="nopar" >
     </li>
     <li 
  class="enumerate" id="x16-46016x8">This should yield a linear array of Rb-Sr data. Let us now fit an
     isochron through these data. <span 
class="cmtt-10">Matlab </span>includes several functions to
     perform linear regression, including <span 
class="cmtt-10">regress </span>and <span 
class="cmtt-10">fitlm</span>. We will use
     the <span 
class="cmtt-10">polyfit </span>function:
                                                           
                                                           
     <div class="verbatim" id="verbatim-21">
     %&#x00A0;Fit&#x00A0;a&#x00A0;first&#x00A0;order&#x00A0;polynomial&#x00A0;through&#x00A0;the&#x00A0;data:
     &#x00A0;<br />[fit,S]&#x00A0;=&#x00A0;polyfit(Rb87Sr86,Sr87Sr86,1);
     &#x00A0;<br />%&#x00A0;(S&#x00A0;will&#x00A0;be&#x00A0;used&#x00A0;in&#x00A0;a&#x00A0;later&#x00A0;practical)
     &#x00A0;<br />
     &#x00A0;<br />%&#x00A0;define&#x00A0;the&#x00A0;87Rb&#x00A0;decay&#x00A0;constant&#x00A0;(in&#x00A0;Ma-1):
     &#x00A0;<br />lam87&#x00A0;=&#x00A0;1.42e-5;
     &#x00A0;<br />%&#x00A0;compute&#x00A0;the&#x00A0;age&#x00A0;from&#x00A0;the&#x00A0;slope:
     &#x00A0;<br />age&#x00A0;=&#x00A0;log(1&#x00A0;+&#x00A0;fit(1))/lam87;
     &#x00A0;<br />
     &#x00A0;<br />%&#x00A0;predict&#x00A0;the&#x00A0;Sr87Sr86-ratio&#x00A0;for&#x00A0;the
     &#x00A0;<br />%&#x00A0;full&#x00A0;range&#x00A0;of&#x00A0;Rb87Sr86-values:
     &#x00A0;<br />x&#x00A0;=&#x00A0;[0,max(Rb87Sr86)];
     &#x00A0;<br />y&#x00A0;=&#x00A0;fit(2)&#x00A0;+&#x00A0;fit(1)*x;
     &#x00A0;<br />
     &#x00A0;<br />#&#x00A0;add&#x00A0;the&#x00A0;prediction&#x00A0;and&#x00A0;age&#x00A0;to&#x00A0;the&#x00A0;existing&#x00A0;plot:
     &#x00A0;<br />hold&#x00A0;on;
     &#x00A0;<br />plot(x,y,'-r')
     &#x00A0;<br />title(age)
</div>
     <!--l. 3186--><p class="nopar" >
     </li></ol>
<!--l. 3190--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">12.3   </span> <a 
 id="x16-4700012.3"></a>U-Th-Pb data reduction</h3>
<!--l. 3193--><p class="noindent" >You are supplied with two data files that were produced by the quadrupole
laser ablation ICP-MS system at UCL&#8217;s London Geochronology Centre. At
the time of the analysis, this instrument could not resolve <sup><span 
class="cmr-7">204</span></sup>Pb from the
isobaric interference at <sup><span 
class="cmr-7">204</span></sup>Hg. Therefore, it is not possible to apply a
common lead correction as explained in Section <a 
href="indexch5.html#x8-180005">5<!--tex4ht:ref: sec:U-Pb --></a>. However, this does not
cause any major issues to us because:
<!--l. 3201--><p class="indent" >
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x16-47002x1">The  mineral  analysed  is  zircon,  which  incorporates  very  little
     common Pb in its crystal structure during crystallisation.
                                                           
                                                           
     </li>
     <li 
  class="enumerate" id="x16-47004x2">The ages are sufficiently old for the radiogenic Pb to dominate
     the common Pb component by orders of magnitude.</li></ol>
<!--l. 3208--><p class="indent" >   In this exercise, we will use standard-sample bracketing (Section&#x00A0;<a 
href="indexch3.html#x6-120003.3">3.3<!--tex4ht:ref: sec:bracketing --></a>) to
process some raw mass spectrometer data in <span 
class="cmtt-10">R </span>or <span 
class="cmtt-10">Matlab</span>:
<!--l. 3212--><p class="indent" >
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x16-47006x1">Load the input files <span 
class="cmtt-10">91500.csv </span>(sample) and <span 
class="cmtt-10">GJ1.csv </span>(standard)
     into memory.
     </li>
     <li 
  class="enumerate" id="x16-47008x2">Plot the <sup><span 
class="cmr-7">238</span></sup>U signal against time. The resulting curve consists
     of three segments: (i) the first 20 seconds record the background
     (&#8216;blank&#8217;)  signal  of  the  ICP-MS,  measured  while  the  laser  was
     switched  off;  (ii)  20&#x00A0;seconds  into  the  run,  the  laser  is  turned
     on and the ions arrive in the ICP-MS; (iii) After the signal has
     ramped up quickly, it slowly drops over time as the laser goes out
     of focus whilst drilling deeper into the sample. This is the &#8216;signal&#8217;.
     </li>
     <li 
  class="enumerate" id="x16-47010x3">Given  that  GJ-1  has  a  known  age  of  600.4  Ma,  what  are  its
     expected <sup><span 
class="cmr-7">206</span></sup>Pb/<sup><span 
class="cmr-7">238</span></sup>U and <sup><span 
class="cmr-7">207</span></sup>Pb/<sup><span 
class="cmr-7">235</span></sup>U ratios?
     </li>
     <li 
  class="enumerate" id="x16-47012x4">Compare these values with the arithmetic mean of the measured
     ratios, ignoring the first 25&#x00A0;seconds of the ICP-MS signal. Is there
     a significant difference between the measured and the expected
     ratios? What could be causing this?
     </li>
     <li 
  class="enumerate" id="x16-47014x5">Calculate a correction factor by dividing the expected GJ-1 ratios
     by the measured values. <a 
 id="x16-470135"></a>
     </li>
     <li 
  class="enumerate" id="x16-47016x6">Calculate the measured isotopic ratios for sample 91500.
     </li>
     <li 
  class="enumerate" id="x16-47018x7">Apply  the  correction  factor  calculated  in  step  <a 
href="#x16-470135">5<!--tex4ht:ref: corr --></a>  to  these
     measurements.
     </li>
     <li 
  class="enumerate" id="x16-47020x8">What is the age of 91500?
                                                           
                                                           
     </li>
     <li 
  class="enumerate" id="x16-47022x9">Can you plot the results on a Wetherill concordia diagram?</li></ol>
<!--l. 3239--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">12.4   </span> <a 
 id="x16-4800012.4"></a><sup><span 
class="cmr-7">40</span></sup>Ar/<sup><span 
class="cmr-7">39</span></sup>Ar data reduction</h3>
<!--l. 3242--><p class="noindent" >In this exercise, we will reduce some synthetic <sup><span 
class="cmr-7">40</span></sup>Ar/<sup><span 
class="cmr-7">39</span></sup>Ar data. You are
provided with three input files:
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x16-48002x1"><span 
class="cmtt-10">smpl.csv</span>: <sup><span 
class="cmr-7">36</span></sup>Ar, <sup><span 
class="cmr-7">39</span></sup>Ar and <sup><span 
class="cmr-7">40</span></sup>Ar as a function of time (t) for the
     sample.
     </li>
     <li 
  class="enumerate" id="x16-48004x2"><span 
class="cmtt-10">stnd.csv</span>: the same data for the standard, which is a Fish Canyon
     sanidine with a conventional K-Ar age of 27.8 Ma.
     </li>
     <li 
  class="enumerate" id="x16-48006x3"><span 
class="cmtt-10">blnk.csv</span>: a &#8216;blank&#8217; run, i.e. a measurement of the background
     levels of Argon present in the mass spectrometer in the absence
     of a sample.</li></ol>
<!--l. 3254--><p class="indent" >   To perform the data reduction, please follow the following steps:
<!--l. 3256--><p class="indent" >
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x16-48008x1">Load the three input files.
     </li>
     <li 
  class="enumerate" id="x16-48010x2">Plot the <sup><span 
class="cmr-7">40</span></sup>Ar signal of the sample against time. Do the same for
     the <sup><span 
class="cmr-7">36</span></sup>Ar signal in the blank. What is the difference?
     </li>
     <li 
  class="enumerate" id="x16-48012x3">Perform a linear regression of the <sup><span 
class="cmr-7">36</span></sup>Ar, <sup><span 
class="cmr-7">39</span></sup>Ar and <sup><span 
class="cmr-7">40</span></sup>Ar signals
     through time and determine the intercept at t=0.
     </li>
     <li 
  class="enumerate" id="x16-48014x4">Subtract the &#8216;time zero&#8217; intercepts of the blank from those of the
     sample and standard.
     </li>
     <li 
  class="enumerate" id="x16-48016x5">Apply an atmospheric correction assuming that all <sup><span 
class="cmr-7">36</span></sup>Ar has an
     atmospheric origin.
                                                           
                                                           
     </li>
     <li 
  class="enumerate" id="x16-48018x6">Calculate the J-value of the standard.
     </li>
     <li 
  class="enumerate" id="x16-48020x7">Calculate the age of the sample.</li></ol>
<!--l. 3270--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">12.5   </span> <a 
 id="x16-4900012.5"></a>Error propagation</h3>
<!--l. 3273--><p class="noindent" >This exercise will build on the results from the previous two practicals.
<!--l. 3276--><p class="indent" >
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x16-49002x1">Plot the <sup><span 
class="cmr-7">206</span></sup>Pb/<sup><span 
class="cmr-7">238</span></sup>U-ratios of the sample against those of the
     standard  (data  from  Section  <a 
href="#x16-4700012.3">12.3<!--tex4ht:ref: sec:U-Pb-R --></a>).  Verify  that  the  covariance
     between the two can safely be neglected.
     </li>
     <li 
  class="enumerate" id="x16-49004x2">Calculate  the  standard  errors  of  the  mean  <sup><span 
class="cmr-7">206</span></sup>Pb/<sup><span 
class="cmr-7">238</span></sup>U  signal
     ratios for the sample (91500) and the standard (GJ-1) using the
     <span 
class="cmtt-10">mean </span>and <span 
class="cmtt-10">sd </span>(for <span 
class="cmtt-10">R</span>) or <span 
class="cmtt-10">std </span>(for <span 
class="cmtt-10">Matlab</span>) functions.
     </li>
     <li 
  class="enumerate" id="x16-49006x3">Propagate the analytical uncertainties of the U-Pb age, ignoring
     the covariance terms. Recall that
     <!--l. 3290--><p class="noindent" >
     <center class="math-display" >
     <img 
src="index121x.png" alt="         (         )
   -1--       206P-b
t = &#x03BB;238 ln 1 + 238U
     " class="math-display" ></center>
                                                           
                                                           
     <!--l. 3293--><p class="noindent" >If  you  want  you  can  use  the  simplifying  approximation  that
     ln(1+X) <span 
class="cmsy-10">&#x2248; </span><span 
class="cmmi-10">X </span>if X <span 
class="cmsy-10">&#x226A; </span>1 (this assumption may not be correct for
     the <sup><span 
class="cmr-7">207</span></sup>Pb/<sup><span 
class="cmr-7">235</span></sup>U-age). <a 
 id="x16-490053"></a>
     </li>
     <li 
  class="enumerate" id="x16-49008x4">Compute the analytical uncertainties associated with the linear
     extrapolation of the argon signals of the sample and the standard
     in  Section  <a 
href="#x16-4800012.4">12.4<!--tex4ht:ref: sec:Ar-Ar-R --></a>.  If  you  use  <span 
class="cmtt-10">R</span>,  the  covariance  matrix  of  the
     slope and intercept can be simply obtained from the <span 
class="cmtt-10">vcov(fit)</span>
     function, where <span 
class="cmtt-10">fit </span>is the output of the <span 
class="cmtt-10">lm </span>function (see item&#x00A0;<a 
href="#x16-450158">8<!--tex4ht:ref: itm:lm --></a> of
     Section&#x00A0;<a 
href="#x16-4500012.1">12.1<!--tex4ht:ref: sec:R --></a>). The corresponding standard errors are then found
     by taking the square root of the diagonal elements of this matrix.
     <!--l. 3307--><p class="noindent" >For <span 
class="cmtt-10">Matlab</span>, all the relevant information is provided in the output
     of the <span 
class="cmtt-10">polyfit </span>function:
                                                           
                                                           
     <div class="verbatim" id="verbatim-22">
     help(polyfit)
     &#x00A0;<br />...
     &#x00A0;<br />[P,S]&#x00A0;=&#x00A0;POLYFIT(X,Y,N)&#x00A0;returns&#x00A0;the&#x00A0;polynomial
     &#x00A0;<br />coefficients&#x00A0;P&#x00A0;and&#x00A0;a&#x00A0;structure&#x00A0;S&#x00A0;for&#x00A0;use&#x00A0;with
     &#x00A0;<br />POLYVAL&#x00A0;to&#x00A0;obtain&#x00A0;error&#x00A0;estimates&#x00A0;for&#x00A0;predictions.
     &#x00A0;<br />S&#x00A0;contains&#x00A0;fields&#x00A0;for&#x00A0;the&#x00A0;triangular&#x00A0;factor&#x00A0;(R)
     &#x00A0;<br />from&#x00A0;a&#x00A0;QR&#x00A0;decomposition&#x00A0;of&#x00A0;the&#x00A0;Vandermonde&#x00A0;matrix
     &#x00A0;<br />of&#x00A0;X,&#x00A0;the&#x00A0;degrees&#x00A0;of&#x00A0;freedom&#x00A0;(df),&#x00A0;and&#x00A0;the&#x00A0;norm
     &#x00A0;<br />of&#x00A0;the&#x00A0;residuals&#x00A0;(normr).&#x00A0;If&#x00A0;the&#x00A0;data&#x00A0;Y&#x00A0;are
     &#x00A0;<br />random,&#x00A0;an&#x00A0;estimate&#x00A0;of&#x00A0;the&#x00A0;covariance&#x00A0;matrix
     &#x00A0;<br />of&#x00A0;P&#x00A0;is&#x00A0;(Rinv*Rinv')*normr^2/df,&#x00A0;where&#x00A0;Rinv
     &#x00A0;<br />is&#x00A0;the&#x00A0;inverse&#x00A0;of&#x00A0;R.
</div>
     <!--l. 3323--><p class="nopar" >
     <!--l. 3325--><p class="noindent" >Based on these instructions, I have written the following function to
     calculate the standard errors of the fitting parameters from the second
     output parameter of the <span 
class="cmtt-10">polyfit </span>function:
                                                           
                                                           
     <div class="verbatim" id="verbatim-23">
     function&#x00A0;se&#x00A0;=&#x00A0;S2se(S)
     &#x00A0;<br />&#x00A0;&#x00A0;covmat&#x00A0;=&#x00A0;(inv(S.R)*inv(S.R'))*S.normr^2/S.df;
     &#x00A0;<br />&#x00A0;&#x00A0;se&#x00A0;=&#x00A0;sqrt(diag(covmat));
     &#x00A0;<br />end
</div>
     <!--l. 3334--><p class="nopar" >
     </li>
     <li 
  class="enumerate" id="x16-49010x5">Use these error estimates to propagate the analytical uncertainty of
     the J-value and the sample age. Again you can use the linear
     approximation to the age equation mentioned in point <a 
href="#x16-490053">3<!--tex4ht:ref: loglin --></a>.
     </li></ol>
<!--l. 3343--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">12.6   </span> <a 
 id="x16-5000012.6"></a>Fission tracks</h3>
<!--l. 3346--><p class="noindent" >In this exercise, you will use your programming skills to calculate some
fission track ages. You are given the following datasets:
<!--l. 3349--><p class="indent" >
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x16-50002x1"><span 
class="cmtt-10">DUR.csv</span>:  a  table  with  two  columns  listing  the  number  of
     spontaneous  tracks  <span 
class="cmmi-10">N</span><sub><span 
class="cmmi-7">s</span></sub>  and  induced  tracks  <span 
class="cmmi-10">N</span><sub><span 
class="cmmi-7">i</span></sub>  counted  in  25
     grains of an apatite age standard (t = 31.4 Ma) from Durango,
     Mexico. Note that these pairs of tracks were counted over the
     same area, so that <span 
class="cmmi-10">&#x03C1;</span><sub><span 
class="cmmi-7">s</span></sub><span 
class="cmmi-10">&#x2215;&#x03C1;</span><sub><span 
class="cmmi-7">i</span></sub> = <span 
class="cmmi-10">N</span><sub><span 
class="cmmi-7">s</span></sub><span 
class="cmmi-10">&#x2215;N</span><sub><span 
class="cmmi-7">i</span></sub> in Equation&#x00A0;<a 
href="indexch7.html#x10-29004r9">7.9<!--tex4ht:ref: eq:tzeta --></a>.
     </li>
     <li 
  class="enumerate" id="x16-50004x2"><span 
class="cmtt-10">MD.csv</span>:  a  similar  table  for  an  apatite  sample  from  Mount
     Dromedary, Australia.</li></ol>
<!--l. 3360--><p class="indent" >   You will need to:
<!--l. 3362--><p class="indent" >
                                                           
                                                           
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x16-50006x1">Rewrite Equation <a 
href="indexch7.html#x10-29004r9">7.9<!--tex4ht:ref: eq:tzeta --></a> in terms of the <span 
class="cmmi-10">&#x03B6; </span>calibration factor and
     use this new formula to calculate the <span 
class="cmmi-10">&#x03B6; </span>factor for each single
     grain analysis of the Durango age standard. Use a dosimeter track
     density of <span 
class="cmmi-10">&#x03C1;</span><sub><span 
class="cmmi-7">D</span></sub> = 300<span 
class="cmmi-10">,</span>000 cm<sup><span 
class="cmsy-7">-</span><span 
class="cmr-7">2</span></sup>.
     </li>
     <li 
  class="enumerate" id="x16-50008x2">Use the mean of these <span 
class="cmmi-10">&#x03B6; </span>factors to calculate the age of the Mount
     Dromedary sample (i.e., the single grain ages and their mean).
     </li>
     <li 
  class="enumerate" id="x16-50010x3">Propagate the analytical uncertainties for each of those single
     grain ages, using the fact that fission track counts (N, say) follow
     a Poisson distribution for which it is true that:
     <!--l. 3375--><p class="noindent" >
     <center class="math-display" >
     <img 
src="index122x.png" alt="&#x03C3;2N = N
     " class="math-display" ></center>
     <!--l. 3377--><p class="noindent" >To  simplify  the  calculations,  you  can  also  use  the  following
     approximation:
     <!--l. 3380--><p class="noindent" >
     <center class="math-display" >
     <img 
src="index123x.png" alt=" 1  (    gi    Ns )   gi   Ns
&#x03BB;-ln 1 + g-&#x03BB;&#x03B6;&#x03C1;dN--  &#x2248; g-&#x03B6;&#x03C1;dN--
          s      i     s    i
     " class="math-display" ></center>
     </li>
     <li 
  class="enumerate" id="x16-50012x4">How does the single grain age precision of the fission track method
     compare to the U-Pb and <sup><span 
class="cmr-7">40</span></sup>Ar/<sup><span 
class="cmr-7">39</span></sup>Ar age uncertainties in Sections
     <a 
href="#x16-4700012.3">12.3<!--tex4ht:ref: sec:U-Pb-R --></a> and <a 
href="#x16-4800012.4">12.4<!--tex4ht:ref: sec:Ar-Ar-R --></a>? Also compare with the standard deviation and
     standard error of the mean age of Mount Dromedary apatite.
     </li></ol>
<!--l. 3391--><p class="indent" >
                                                           
                                                           
<!--l. 3391--><p class="indent" >   &#x00A0;
                                                           
                                                           
<!--l. 3392--><p class="indent" >   &#x00A0;
                                                           
                                                           
   <!--l. 3394--><div class="crosslinks"><p class="noindent">[<a 
href="indexch11.html" >prev</a>] [<a 
href="indexch11.html#tailindexch11.html" >prev-tail</a>] [<a 
href="indexch12.html" >front</a>] [<a 
href="index.html#indexch12.html" >up</a>] </p></div>
<!--l. 3394--><p class="indent" >   <a 
 id="tailindexch12.html"></a>   
</body></html> 
